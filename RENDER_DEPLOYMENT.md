# Render Deployment Guide for Stock Analyzer

This guide will help you deploy your Stock Analyzer application to Render.com without losing any functionality.

## Prerequisites

1. **GitHub Repository**: Your code should be in a GitHub repository
2. **MongoDB Database**: You'll need a MongoDB database (MongoDB Atlas recommended)
3. **Render Account**: Sign up at [render.com](https://render.com)

## Step 1: Set Up MongoDB Database

### Option A: MongoDB Atlas (Recommended)

1. Go to [MongoDB Atlas](https://www.mongodb.com/cloud/atlas)
2. Create a free account and cluster
3. Create a database user
4. Get your connection string (it should look like this):
   ```
   mongodb+srv://username:password@cluster.mongodb.net/stock_analyzer?retryWrites=true&w=majority
   ```

### Option B: Self-hosted MongoDB

If you have your own MongoDB instance, prepare the connection details.

## Step 2: Deploy to Render

### Method 1: Using render.yaml (Recommended)

1. **Push to GitHub**: Make sure your code is in a GitHub repository

2. **Connect to Render**:
   - Go to [Render Dashboard](https://dashboard.render.com/)
   - Click "New +"
   - Select "Blueprint"
   - Connect your GitHub repository
   - Render will automatically detect the `render.yaml` file

3. **Set Environment Variables**:
   - In the Render dashboard, go to your service
   - Navigate to "Environment" tab
   - Add the following environment variables:

   ```
   MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/stock_analyzer
   SECRET_KEY=(will be auto-generated)
   FLASK_ENV=production
   NODE_ENV=production
   MONGO_DB=stock_analyzer
   ```

### Method 2: Manual Setup

1. **Create Web Service**:
   - Go to Render Dashboard
   - Click "New +" â†’ "Web Service"
   - Connect your GitHub repository
   - Configure:
     - **Runtime**: Python 3
     - **Build Command**: 
       ```bash
       curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash - && 
       sudo apt-get install -y nodejs && 
       cd frontend && npm ci && npm run build && cd .. && 
       cd backend && pip install -r requirements.txt
       ```
     - **Start Command**: 
       ```bash
       cd backend && gunicorn --bind 0.0.0.0:$PORT --workers 1 --timeout 120 app:app
       ```

2. **Set Environment Variables** (same as Method 1)

## Step 3: Configure Environment Variables

In your Render service environment variables, set:

| Variable | Value | Description |
|----------|-------|-------------|
| `MONGODB_URI` | Your MongoDB connection string | Database connection |
| `SECRET_KEY` | Auto-generated by Render | Flask secret key |
| `FLASK_ENV` | `production` | Flask environment |
| `NODE_ENV` | `production` | Node.js environment |
| `MONGO_DB` | `stock_analyzer` | Database name |

## Step 4: Verify Deployment

1. **Check Build Logs**: Monitor the deployment in Render dashboard
2. **Test Application**: 
   - Visit your Render URL (e.g., https://your-app-name.onrender.com)
   - Test user registration/login
   - Test stock search functionality
   - Test portfolio management
   - Test AI predictions

## Step 5: Custom Domain (Optional)

1. Go to your service settings in Render
2. Navigate to "Custom Domains"
3. Add your domain name
4. Configure DNS according to Render's instructions

## Troubleshooting

### Common Issues:

1. **Build Fails**:
   - Check Node.js and Python versions in logs
   - Verify all dependencies are in package.json and requirements.txt

2. **Database Connection Issues**:
   - Verify MONGODB_URI is correct
   - Check MongoDB Atlas network access (allow all IPs: 0.0.0.0/0)
   - Ensure database user has read/write permissions

3. **Frontend Not Loading**:
   - Check if build created `frontend/dist` folder
   - Verify static file serving in Flask app

4. **API Errors**:
   - Check environment variables are set correctly
   - Monitor application logs in Render dashboard

### Useful Commands for Local Testing:

```bash
# Test frontend build
cd frontend
npm run build
ls -la dist/

# Test backend with production settings
cd backend
FLASK_ENV=production python app.py

# Test full stack locally
npm run build  # from root directory
npm start      # from root directory
```

## Performance Optimization

1. **Database Indexing**: MongoDB indexes are automatically created
2. **Static File Caching**: Configured in Flask app
3. **Session Management**: Uses filesystem sessions
4. **CORS**: Optimized for production

## Security Features

- Environment-based configuration
- Secure session cookies in production
- CORS properly configured
- Database connection encryption
- Secret key auto-generation

## Monitoring

- Monitor your application through Render dashboard
- Check logs for any errors
- Set up uptime monitoring if needed

## Scaling

On Render's free tier:
- 512MB RAM
- 0.1 CPU
- Automatic sleeping after 15 minutes of inactivity

For higher traffic, consider upgrading to a paid plan.

## Support

If you encounter issues:
1. Check Render documentation
2. Review application logs
3. Verify environment variables
4. Test locally with production settings

Your Stock Analyzer is now ready for production deployment on Render! ðŸš€
